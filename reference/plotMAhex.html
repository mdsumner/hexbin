<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MA-plot using hexagon bins — plotMAhex • hexbin</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MA-plot using hexagon bins — plotMAhex"><meta property="og:description" content="Creates an MA-plot using hexagons with color/glyph coding for control spots."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hexbin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.28.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edzer/hexbin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MA-plot using hexagon bins</h1>
    
    <div class="hidden name"><code>plotMAhex.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates an MA-plot using hexagons with color/glyph coding for control spots.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotMAhex</span><span class="op">(</span><span class="va">MA</span>, array <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"A"</span>, ylab <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>          main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MA</span><span class="op">)</span><span class="op">[</span><span class="va">array</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="cn">NULL</span>, ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          status <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">values</span>, <span class="va">pch</span>, <span class="va">col</span>, <span class="va">cex</span>, nbin <span class="op">=</span> <span class="fl">40</span>,</span>
<span>          zero.weights <span class="op">=</span> <span class="cn">FALSE</span>, style <span class="op">=</span> <span class="st">"colorscale"</span>, legend <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>          lcex <span class="op">=</span> <span class="fl">1</span>, minarea <span class="op">=</span> <span class="fl">0.04</span>, maxarea <span class="op">=</span> <span class="fl">0.8</span>, mincnt <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          maxcnt <span class="op">=</span> <span class="cn">NULL</span>, trans <span class="op">=</span> <span class="cn">NULL</span>, inv <span class="op">=</span> <span class="cn">NULL</span>, colorcut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          border <span class="op">=</span> <span class="cn">NULL</span>, density <span class="op">=</span> <span class="cn">NULL</span>, pen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          colramp <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="colramp.html">LinGray</a></span><span class="op">(</span><span class="va">n</span>, beg <span class="op">=</span> <span class="fl">90</span>, end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">}</span>,</span>
<span>          newpage <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"l"</span>, <span class="st">"n"</span><span class="op">)</span>,</span>
<span>          xaxt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"n"</span><span class="op">)</span>, yaxt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"n"</span><span class="op">)</span>,</span>
<span>          verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>MA</dt>
<dd><p>an <code>RGList</code>, <code>MAList</code> or <code>MArrayLM</code> object,
    or any list with components <code>M</code> containing log-ratios and
    <code>A</code> containing average intensities. Alternatively a
    <code>matrix</code>, <code>Affybatch</code> or <code>ExpressionSet</code> object.</p></dd>

  <dt>array</dt>
<dd><p>integer giving the array to be plotted. Corresponds to
    columns of <code>M</code> and <code>A</code>.</p></dd>

  <dt>xlab, ylab, main</dt>
<dd><p>character strings giving label for x-axis,
    y-axis or main tile of the plot.</p></dd>

  <dt>xlim, ylim</dt>
<dd><p>numeric vectors of length 2 giving limits for x-axis
    (or y-axis respectively), defaulting to min and max of the data.</p></dd>

  <dt>status</dt>
<dd><p>character vector giving the control status of each spot
    on the array, of same length as the number of rows of <code>MA$M</code>.
    If omitted, all points are plotted in the default color, symbol and size.</p></dd>

  <dt>values</dt>
<dd><p>character vector giving values of <code>status</code> to be
    highlighted on the plot. Defaults to unique values of <code>status</code>.
    Ignored if there is no <code>status</code> vector.</p></dd>

  <dt>pch</dt>
<dd><p>vector or list of plotting characters. Default to integer code 16.
    Ignored is there is no <code>status</code> vector.</p></dd>

  <dt>col</dt>
<dd><p>numeric or character vector of colors, of the same length
    as <code>values</code>. Defaults to <code>1:length(values)</code>.  Ignored if
    there is no <code>status</code> vector.</p></dd>

  <dt>cex</dt>
<dd><p>numeric vector of plot symbol expansions, of the the same
    length as <code>values</code>.  Defaults to 0.2 for the most common status
    value and 1 for the others. Ignored if there is no <code>status</code> vector.</p></dd>

  <dt>nbin</dt>
<dd><p>Number of bins</p></dd>
  </dl><p><!-- %% &lt;&lt; FIXME --></p>
<dl><dt>zero.weights</dt>
<dd><p>logical, should spots with zero or negative
    weights be plotted?</p></dd>

  <dt>style</dt>
<dd><p>string specifying the style of hexagon plot,
      see <code><a href="grid.hexagons.html">grid.hexagons</a></code> for the possibilities.</p></dd>

  <dt>legend</dt>
<dd><p>numeric width of the legend in inches of <code>FALSE</code>.
    In the latter case, or when <code>0</code>, no legend is not produced.</p></dd>

  <dt>lcex</dt>
<dd><p>characters  expansion size for the text in the legend.</p></dd>

  <dt>minarea</dt>
<dd><p>fraction of cell area for the lowest count.</p></dd>

  <dt>maxarea</dt>
<dd><p>fraction of the cell area for the largest count.</p></dd>

  <dt>mincnt</dt>
<dd><p>cells with fewer counts are ignored.</p></dd>

  <dt>maxcnt</dt>
<dd><p>cells with more counts are ignored.</p></dd>

  <dt>trans</dt>
<dd><p><code><a href="https://rdrr.io/r/base/function.html" class="external-link">function</a></code> specifying a transformation for
    the counts such as <code>sqrt</code>.</p></dd>

    <dt>inv</dt>
<dd><p>the inverse transformation of <code>trans</code>.</p></dd>

  <dt>colorcut</dt>
<dd><p>vector of values covering [0, 1] that determine
    hexagon color class boundaries and hexagon legend size boundaries.
    Alternatively, an integer (<code>&lt;= maxcnt</code>) specifying the
    <em>number</em> of equispaced colorcut values in [0,1].</p></dd>

  <dt>border, density, pen</dt>
<dd><p>color for polygon borders and filling of
    each hexagon drawn, passed to <code><a href="grid.hexagons.html">grid.hexagons</a></code>.</p></dd>

  <dt>colramp</dt>
<dd><p>function accepting an integer <code>n</code> as an argument and
    returning n colors.</p></dd>

  <dt>newpage</dt>
<dd><p>should a new page start?</p></dd>

  <dt>type, xaxt, yaxt</dt>
<dd><p>strings to be used (when set to <code>"n"</code>) for
    suppressing the plotting of hexagon symbols, or the x- or y-axis,
    respectively.</p></dd>

  <dt>verbose</dt>
<dd><p>logical indicating if some diagnostic output should happen.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>An MA-plot is a plot of log-intensity ratios (M-values) versus
  log-intensity averages (A-values). If <code>MA</code> is an <code>RGList</code> or
  <code>MAList</code> then this function produces an ordinary within-array
  MA-plot. If <code>MA</code> is an <code>MArrayLM</code> object, then the plot is an
  fitted model MA-plot in which the estimated coefficient is on the y-axis
  and the average A-value is on the x-axis.</p>
<p>If <code>MA</code> is a <code>matrix</code> or <code>ExpressionSet</code> object, then this
  function produces a between-array MA-plot. In this case the A-values in
  the plot are the average log-intensities across the arrays and the
  M-values are the deviations of the log-intensities for the specified
  array from the average. If there are more than five arrays, then the
  average is computed robustly using medians. With five or fewer arrays,
  it is computed by means.</p>
<p>The <code>status</code> vector is intended to specify the control status of
  each spot, for example "gene", "ratio control", "house keeping gene",
  "buffer" and so on. The vector is usually computed using the function
  <code><a href="https://rdrr.io/pkg/limma/man/controlStatus.html" class="external-link">controlStatus</a></code> from package <span class="pkg">limma</span> and a
  spot-types file.  However the function may be used to highlight any
  subset of spots.</p>
<p>The arguments <code>values</code>, <code>pch</code>, <code>col</code> and <code>cex</code>
  can be included as attributes to <code>status</code> instead of being
  passed as arguments to <code>plotMA</code>.</p>
<p>See <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code> for possible values for <code>pch</code>,
  <code>col</code> and <code>cex</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A plot is created on the current graphics device.
  and a list with the following items is returned invisibly:</p>
<dl><dt>plot.vp</dt>
<dd><p>the <code><a href="hexViewport.html">hexViewport</a></code> constructed and used.</p></dd>

  <dt>legend.vp</dt>
<dd><p>if a legend has been produced, its
    <code><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></code>.</p></dd>

  <dt>hbin</dt>
<dd><p>a <code>hexbin</code> object built with A as the x coordinate
    and M as the y coordinate.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>See <a href="http://www.statsci.org/micrarra/refs/maplots.html" class="external-link">http://www.statsci.org/micrarra/refs/maplots.html</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nicholas Lewin-Koh, adapted from code by Gordon Smyth</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>plotMA</code> from package <span class="pkg">limma</span>,
  and <code><a href="gplot.hexbin.html">gplot.hexbin</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.maths.usyd.edu.au/u/jeany/" class="external-link">marray</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swirl</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">hb</span> <span class="op">&lt;-</span> <span class="fu">plotMAhex</span><span class="op">(</span><span class="va">swirl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,newpage<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                    main <span class="op">=</span> <span class="st">"M vs A plot with hexagons"</span>, legend<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="hexVP.abline.html">hexVP.abline</a></span><span class="op">(</span><span class="va">hb</span><span class="op">$</span><span class="va">plot.vp</span>,h<span class="op">=</span><span class="fl">0</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="hexMA.loess.html">hexMA.loess</a></span><span class="op">(</span><span class="va">hb</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-plt img"><img src="plotMAhex-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

